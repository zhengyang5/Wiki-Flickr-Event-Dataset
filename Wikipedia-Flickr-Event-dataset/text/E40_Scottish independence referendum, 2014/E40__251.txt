Angus MacNeil, the SNP’s rural affairs spokesman, told the BBC that both Shetland and Orkney would be permitted to remain part of the UK regardless of the referendum result “if there was a big enough drive for self-determination” among their residents.

If they did not join a separate Scotland, he said the islands would retain control over a “fair fraction” of the North Sea oil and gas that Alex Salmond is relying on to fund public services.

The Western Isles MP was reacting to a submission to the Government’s consultation on the referendum by the MSPs for Shetland and Orkney, who warned the islands could opt to remain part of the UK even if the rest of Scotland votes to separate.

Alternatively, its residents may choose to join a separate Scotland in return for a much larger share of oil and gas revenues from their waters or even declare independence themselves.

Tavish Scott and Liam McArthur, the Liberal Democrat MSPs who wrote the paper, last night welcomed Mr MacNeil’s confirmation of the SNP’s previous policy that the islands have the right to determine their own future.

Their residents have traditionally been extremely hostile to Scottish independence and preferred Westminster government to that from Holyrood. They were part of Norway, not Scotland, until the late 15th century.

Speaking on the BBC’s Daily Politics programme, Mr MacNeil initially argued that the idea of Shetland and Orkney not being bound by the referendum result was “null and void” and a “non-starter”.

But pressed whether they would be allowed to remain part of the UK if the rest of Scotland votes for separation, he said: “If there was a big enough drive for self determination, that has to be respected.”

Asked by presenter Andrew Neil how much North Sea oil and gas would be retained by Shetland and Orkney if they remained part of the UK, the MP said: “A fair fraction of oil.”

It is thought around a quarter of the remaining oil lies in their seas but the MP said it was “absolutely wrong” that the SNP’s economic case for separation collapses without the islands’ natural resources.

“When you look at countries the size of Scotland with no oil, you see them thriving. Switzerland is a great example,” he added.

An opt-out clause was negotiated in the failed Scottish devolution referendum of 1979, which the islanders opposed, and the Earl of Caithness last month tabled plans in the House of Lords for a similar safeguard in the independence referendum.

Mr Scott and Mr McArthur welcomed the SNP’s change of heart. Mr Scott, the Shetland MSP and former Scottish Lib Dem leader, said: “Angus MacNeil has now confirmed the SNP’s policy of accepting the Northern Isles’ right to determine their own future.”

Mr McArthur, the Orkney MSP, said: “All the SNP’s accusations that we have been troublemaking has been shown to be bluster. We certainly welcome this confirmation.”