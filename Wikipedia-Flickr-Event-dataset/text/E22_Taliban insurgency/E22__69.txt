Up to nine Indians, an Italian diplomat and a French film maker were among the dead in the worst assault on the Afghan capital for several months.

Witnesses said a four-hour battle began with a car bombing and included suicide bombers and Taliban fighters throwing grenades.

Guests were knocked from their beds by the early morning explosions and locked themselves in their rooms or climbed from windows as fighters opened fire.

The Taliban claimed responsibility and Hamid Karzai, the Afghan president, said the attacks appeared to be aimed at Indian government officials and medical workers.

Three Afghan police were killed, and six more officers were among the 38 people wounded in what was described as a well-planned and co-ordinated attack.

India is one of Afghanistan's biggest donors, but its presence has provoked opposition and suspicion in Pakistan, which fears encirclement by its larger neighbour.

The Indian embassy in Kabul has twice been hit by devastating car bombings in the past 18 months and one attack was blamed on Pakistan's ISI military spy agency.

SM Krishna, India's foreign minister, said: "These are the handiwork of those who are desperate to undermine the friendship between India and Afghanistan."

The assault began soon after 6.30am with the streets deserted as Afghanistan marked the birth of the prophet Mohammed.

Abdul Rahman Rahman, chief of Kabul police, said a car bomb began the attack, levelling the Arya Guesthouse, popular with Indian doctors working at the city's Indira Gandhi Child Health Institute.

Two other attackers then entered the nearby Park Residence, which also houses visiting foreigners including Indian government officials. One detonated, killing three policemen, and the other was shot dead.

The high-rise, glass-fronted Safi Landmark hotel next door was badly damaged by the blasts and broken windows littered the streets.

Pietro Antonio Colazzo, an Italian diplomatic counsellor, was among the dead and Mr Rahman said he had been shot while telephoning police with information which saved other guests.

He said: "He was killed by the terrorists who realised that he was passing information to police forces.

"He was in a room right behind the attackers and he could see where they were and what they are doing." Silvio Berlusconi, the Italian prime minister, praised Mr Colazzo as a faithful government servant who died doing his job.

Severin Blanchet, a 66-year-old French filmmaker training young Afghans in documentary filmmaking also died.

The attack was the most recent since a team of suicide bombers stormed a shopping centre on January 18, prompting a five hour siege after they failed to penetrate the Afghan central bank.

A similar attack in October targeting United Nations staff in a guesthouse killed five election workers and led the organisation to pull out hundreds of employees from the country.