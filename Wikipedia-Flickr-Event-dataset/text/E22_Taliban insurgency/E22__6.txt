Image caption The US has long suspected Pakistan, or elements within the ISI, of supporting militant groups

The Pakistan army has strongly denied claims made in a BBC documentary that the Pakistani security services are supporting the Taliban in Afghanistan.

Pakistani army spokesman Major Gen Athar Abbas described the allegations made by US and Afghan officials as "baseless and malicious".

He claimed that the US and Afghanistan were trying to blame Pakistan for their own failures.

The first part of the documentary Secret Pakistan aired on Wednesday.

The programme accuses Pakistan of playing a double game, acting as America's ally in public while secretly training and arming its enemy in Afghanistan.

'Miserable performance'

Gen Abbas said the ISI (Pakistani secret service) had itself suffered at the hands of al-Qaeda and its affiliates, saying about 300 officials had died in attacks.

"You think it is sane for any intelligence operator to harbour people who'll attack its own men?" he said.

He also claimed that Pakistan was being used as a scapegoat for the situation in Afghanistan.

"The performance of all intelligence agencies in Afghanistan has been miserable. That's why they want to dump this on Pakistan and the ISI," he said.

"We have the right to take legal action and legal response against the BBC," he added.

BBC spokeswoman Helen Deller said the documentary was made in line with BBC editorial guidelines and did "not attempt to take sides".

"Secret Pakistan was made in accordance with the BBC's editorial guidelines, information we gained was checked with multiple sources and the programme strove to be fair and accurate."

"The Pakistani position and official response to the allegations made not only by Western officials and Taliban fighters but also Pakistani representatives is carried throughout by several different voices."

The US has long suspected Pakistan, or elements within the ISI, of supporting militant groups in order to increase its influence in Afghanistan.

Similar claims in the past have been repeatedly denied by Pakistan.