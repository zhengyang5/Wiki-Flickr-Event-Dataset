KABUL (Reuters) - Heavy fighting between Afghan security forces and Taliban insurgents that killed more than 30 combatants threatened a major northern city on Monday, officials said.

Afghan President Ashraf Ghani participates in "The New Beginning in Afghanistan: A Conversation with H.E. Dr. Mohammad Ashraf Ghani, President of the Islamic Republic of Afghanistan" at Columbia University in New York March 26, 2015. REUTERS/Andrew Kelly

The battle on the outskirts of Kunduz, part of an intensifying wave of attacks after the departure of most foreign troops, led President Ashraf Ghani to delay his departure on a state visit to India by several hours.

Officials said hundreds of Taliban militants had attacked police and army checkposts in the province of Kunduz, the insurgents’ last stronghold before U.S.-led forces drove them from power in 2001.

Now they threaten to overrun parts of the provincial capital, after fighting that killed eight Afghan security personnel and at least two dozen Taliban, a spokesman for the provincial governor said.

“The threat level is very high, but with new reinforcements, our security forces have gained morale,” said Abdul Waseh Basel, the spokesman.

The insurgents overran seven army and police checkpoints in central Kunduz and two districts, Taliban spokesman Zabihullah Mujahid said in an emailed statement.

Presidential spokesman Ajmal Obidy said Ghani left for India late on Monday afternoon. He had delayed his departure for New Delhi to meet NATO’s Gen. John Campbell.

Battles were raging about 6 km (4 miles) south of Kunduz city, officials said. Islamist insurgents also broke into the city itself, in the southern district of Gul Tepa, Basel said.

Afghan security forces used artillery in defense.

“The sound of heavy weapons fired by Afghan forces can be heard in the city,” said Kunduz police spokesman Sayed Sarwar Hussaini.

Fighting continued into the evening, but Afghan forces pushed the Taliban back with help from reinforcements from Kabul and other areas, said local army commander Qadam Shah Shaheen.

“We will win the fight soon,” he said.

Militants this month launched major attacks in another northern province, Badakhshan, and on Monday fired on a government delegation meeting soldiers there.

Their rockets and gunfire narrowly missed the group, led by Ahmad Zia Massoud, head of Ghani’s governance commission, a close aide said. The delegation withdrew by helicopter.

Afghanistan’s long war has also been complicated by some disgruntled Taliban commanders declaring allegiance to Islamic State, the Middle Eastern jihadist movement that controls swathes of Iraq and Syria.

NATO’s Campbell said that such reports had been increasing and “there’s a little bit of money passing back and forth”, but the coalition and Afghan government were working to prevent IS from sending weapons or fighters to Afghanistan.