Russia are funding a comprehensive “East German-style” doping programme for athletes that has been covered up at national and international levels, according to German television.

A documentary screened on the German TV network MDR on Wednesday night alleges not only that up to “99%” of the Russian Olympic team use doping but also that a network of corruption has been put in place to cover up positive tests, involving officials at the Russian anti-doping agency, the doping control laboratory in Moscow, as well as the International Association of Athletics Federations.

David Howman, the general director of the World Anti-Doping Association, described the allegations compiled in the investigative journalist Hajo Seppelt’s documentary as “shocking”. The organisation has said it will “fully investigate”.

Russia came top of the medal table at the winter Olympics in Sochi this year, ahead of Norway and Canada, and none of their athletes was tested as positive during the event.

After carrying out an investigation into modern doping practices before the Sochi games, Seppelt was contacted by two whistleblowers from within Russian sports: Yuliya Stepanova (nee Rusanova), a former 800m runner now banned for abnormalities in her biological passport, and her husband, Vitaliy Stepanov, a former official at the Russian anti-doping agency, Rusada.

In the documentary Stepanova says she was frequently encouraged by her coaches to keep “clean” urine samples in a freezer for tests during training. At the Russian athletics championships she was instructed to text the number of her urine sample to an official, after which she would be able to “sleep in peace”. One covert recording shows her coach handing her pills said to be Oxandrolone, an anabolic steroid banned by the International Olympic Committee.

“The coaches chose a girl, fed her pills and then she’d be off,” Stepanova said. “And the next day she’d be banned and then they’d say: ‘We’ll find a new one.’”

Her husband said the Russian anti-doping agency regularly received calls from the ministry, asking to reveal the identity of athletes who had tested positive. “If it was an unknown athlete, the test remained positive,” he said, “but when it is someone famous, or someone young and a medal hopeful, then it’s a mistake, and it’s not reported.” Other disciplines, such as swimming, skiing or weightlifting, were not tested in the first place.

“You have to dope, that’s how it works in Russia,” Stepanov said. “Functionaries and coaches tell you very clearly that you can only get so far with your natural skills. In order to get medals, you need help. And that help is doping.”

Rusada’s director Nikita Kamaev has denied the allegations, stating on camera that his agency has always worked within the rules: “Allegations that Rusada swapped samples or accepted bribes do not correspond to reality at all.

“All athletes who make such claims have infringed with doping regulations in the past. Such people then contact journalists and tell stories. For professionals, such stories are only laughable.”

But the German documentary collates a number of testimonies by whistleblowers, leaked documents and covert recordings which raise serious questions about the conduct of high-ranking officials with the Russian athletics set-up.

The Russian Athletics Association did not respond when MDR put the allegations to it. Grigory Rodchenkov, the director of Moscow’s doping control lab, told filmmaker Seppelt: “You should be very careful about putting too much faith into these athletes’ claims. These people are experiencing the biggest catastrophe of their lives.” He denied having ever received bribes to cover up doping scandals.

One of the Russian athletes whose positive doping tests may have been covered up, the documentary suggests, is the runner Mariya Savinova, who won gold in the women’s 800m at London 2012. A video clip recorded on a mobile phone in autumn 2014 shows Savinova saying: “How else are we meant to do it? That’s our system, and in Russia it only works with pharma.

“Luckily, my coach works with [one of the head coaches of the Russian athletics federation, Alexey] Melnikov, and he helps to cover up the tests. They let him swap the dates for the controls. And Oxandrolone leaves my body again very quickly. It takes less than 20 days.”

Asked how many members of the Russian Olympic team used doping, the former discus thrower Evgenia Pecherina told Seppelt: “Most of them, the majority, 99%. And you can get absolutely everything. Everything the athlete wants.”

In a further interview, the Russian runner Liliya Shobukhova, a winner of the London and Chicago marathons, alleges she had to pay her own federation $450,000 in order to bribe her way into the 2012 Olympic Games in spite of abnormal blood test results for the period 2009 to 2011. When Shobukhova did not complete the race, she was banned after all and the federation paid her back a third of the money via a shell company. Documents shown in the film appear to show Valentin Balakhnichev, the president of the All-Russia Athletics Federation and treasurer of the IAAF, was aware of the transaction.

When confronted on camera Balakhnichev refused to discuss the matter with the filmmaker. The IAAF has said that its ethics commission has opened an investigation into Shobukhova’s allegations.